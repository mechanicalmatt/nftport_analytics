
import http.client
import math
import re
import matplotlib.pyplot as plt
import numpy as np

conn = http.client.HTTPSConnection("api.nftport.xyz")

headers = {
    'Content-Type': "application/json",
    'Authorization': "####"
}


def total_mints():

    conn.request("GET", "/v0/me/mints?page_number=1", headers=headers)

    res = conn.getresponse()
    data = res.read()

    info = data.decode("utf-8")

    def get_total():
        start = info.find('total')
        x = info[start:]
        return int(x[x.find(':') + 1:x.find(',')])

    return get_total()


total = total_mints()
pages = math.ceil(total / 50)


# def date_count(page):

#     conn.request("GET",
#                  "/v0/me/mints?page_number={}".format(page),
#                  headers=headers)

#     res = conn.getresponse()
#     data = res.read()

#     info = data.decode("utf-8")

#     find = 'mint_date'
#     dates = re.finditer(find, info)
#     date_positions = [i.start() for i in dates]

#     date_list = [info[i:i + 22] for i in date_positions]
#     final_list = [i.strip('mint_date":"') for i in date_list]

#     date_dict = {}

#     for i in final_list:
#         if i in date_dict.keys():
#             date_dict[i] += 1
#         else:
#             date_dict[i] = 1

#     return date_dict


# final = []

# for i in range(pages):
#     final.append(list(zip(date_count(i).keys(), date_count(i).values())))
#     print('page {}/{}'.format(i, pages))

# print(final)

# for i in final:
#     for j in i:
#         print(j)


####  above returns list of tuples with (date, count) pairing

all = [
  ('2021-08-29', 11),
  ('2021-08-30', 15),
  ('2021-08-31', 2),
  ('2021-09-01', 1),
  ('2021-09-02', 21),
  ('2021-09-02', 2),
  ('2021-09-03', 48),
  ('2021-09-03', 6),
  ('2021-09-04', 36),
  ('2021-09-05', 8),
  ('2021-09-05', 4),
  ('2021-09-06', 19),
  ('2021-09-07', 27),
  ('2021-09-08', 16),
  ('2021-09-09', 8),
  ('2021-09-10', 8),
  ('2021-09-11', 16),
  ('2021-09-12', 2),
  ('2021-09-12', 4),
  ('2021-09-13', 9),
  ('2021-09-14', 15),
  ('2021-09-15', 10),
  ('2021-09-16', 11),
  ('2021-09-17', 1),
  ('2021-09-17', 21),
  ('2021-09-18', 29),
  ('2021-09-18', 5),
  ('2021-09-19', 31),
  ('2021-09-20', 14),
  ('2021-09-20', 6),
  ('2021-09-21', 23),
  ('2021-09-22', 6),
  ('2021-09-23', 14),
  ('2021-09-24', 1),
  ('2021-09-24', 4),
  ('2021-09-25', 15),
  ('2021-09-26', 11),
  ('2021-09-27', 8),
  ('2021-09-28', 7),
  ('2021-09-29', 5),
  ('2021-09-29', 9),
  ('2021-09-30', 11),
  ('2021-10-01', 7),
  ('2021-10-02', 11),
  ('2021-10-03', 12),
  ('2021-10-03', 13),
  ('2021-10-04', 2),
  ('2021-10-05', 10),
  ('2021-10-06', 2),
  ('2021-10-08', 5),
  ('2021-10-09', 13),
  ('2021-10-10', 5),
  ('2021-10-10', 8),
  ('2021-10-11', 7),
  ('2021-10-12', 4),
  ('2021-10-13', 10),
  ('2021-10-14', 8),
  ('2021-10-15', 8),
  ('2021-10-16', 5),
  ('2021-10-16', 2),
  ('2021-10-17', 5),
  ('2021-10-18', 7),
  ('2021-10-19', 8),
  ('2021-10-20', 2),
  ('2021-10-21', 7),
  ('2021-10-22', 7),
  ('2021-10-23', 7),
  ('2021-10-24', 5),
  ('2021-10-24', 14),
  ('2021-10-25', 11),
  ('2021-10-26', 16),
  ('2021-10-27', 9),
  ('2021-10-28', 5),
  ('2021-10-29', 7),
  ('2021-10-30', 23),
  ('2021-10-31', 13),
  ('2021-11-01', 2),
  ('2021-11-01', 3),
  ('2021-11-02', 14),
  ('2021-11-03', 3),
  ('2021-11-04', 12),
  ('2021-11-05', 10),
  ('2021-11-06', 8),
  ('2021-11-07', 5),
  ('2021-11-08', 10),
  ('2021-11-09', 15),
  ('2021-11-10', 5),
  ('2021-11-11', 6),
  ('2021-11-12', 8),
  ('2021-11-13', 1),
  ('2021-11-13', 11),
  ('2021-11-14', 10),
  ('2021-11-15', 12),
  ('2021-11-16', 10),
  ('2021-11-17', 7),
  ('2021-11-17', 5),
  ('2021-11-18', 7),
  ('2021-11-19', 5),
  ('2021-11-20', 13),
  ('2021-11-21', 20),
  ('2021-11-21', 4),
  ('2021-11-22', 4),
  ('2021-11-23', 4),
  ('2021-11-24', 8),
  ('2021-11-25', 11),
  ('2021-11-26', 7),
  ('2021-11-27', 12),
  ('2021-11-27', 1),
  ('2021-11-28', 14),
  ('2021-11-29', 8),
  ('2021-11-30', 7),
  ('2021-12-01', 3),
  ('2021-12-02', 6),
  ('2021-12-03', 4),
  ('2021-12-04', 6),
  ('2021-12-05', 1),
  ('2021-12-05', 7),
  ('2021-12-06', 4),
  ('2021-12-08', 9),
  ('2021-12-09', 4),
  ('2021-12-10', 11),
  ('2021-12-11', 6),
  ('2021-12-12', 5),
  ('2021-12-13', 2),
  ('2021-12-14', 2),
  ('2021-12-14', 4),
  ('2021-12-15', 6),
  ('2021-12-16', 9),
  ('2021-12-17', 6),
  ('2021-12-18', 6),
  ('2021-12-19', 4),
  ('2021-12-20', 6),
  ('2021-12-21', 6),
  ('2021-12-22', 2),
  ('2021-12-23', 1),
  ('2021-12-23', 11),
  ('2021-12-24', 4),
  ('2021-12-25', 8),
  ('2021-12-26', 8),
  ('2021-12-27', 9),
  ('2021-12-28', 10),
  ('2021-12-28', 4),
  ('2021-12-29', 6),
  ('2021-12-30', 4),
  ('2021-12-31', 9),
  ('2022-01-01', 2),
  ('2022-01-02', 3),
  ('2022-01-03', 2),
  ('2022-01-04', 5),
  ('2022-01-05', 2),
  ('2022-01-06', 3),
  ('2022-01-07', 8),
  ('2022-01-08', 2),
  ('2022-01-08', 1),
  ('2022-01-09', 1),
  ('2022-01-10', 8),
  ('2022-01-11', 8),
  ('2022-01-12', 4),
  ('2022-01-13', 9),
  ('2022-01-14', 19),
  ('2022-01-14', 19),
  ('2022-01-15', 22),
  ('2022-01-16', 9),
  ('2022-01-16', 6),
  ('2022-01-17', 44),
  ('2022-01-17', 37),
  ('2022-01-18', 13),
  ('2022-01-18', 50),
  ('2022-01-18', 5),
  ('2022-01-19', 45),
  ('2022-01-19', 20),
  ('2022-01-20', 30),
  ('2022-01-20', 50),
  ('2022-01-20', 11),
  ('2022-01-21', 34),
  ('2022-01-22', 5),
  ('2022-01-22', 10),
  ('2022-01-23', 40),
  ('2022-01-23', 38),
  ('2022-01-24', 12),
  ('2022-01-24', 36),
  ('2022-01-25', 14)
]

####  below plots out results

lst1 = [0]
x_lst = []

for i, j in all[::25]:
  x_lst.append(i)

x_val = []

for i in range(len(x_lst)):
  x_val.append(i * 25)

print(x_val, x_lst)


def climb():
  total = 0
  for i, j in all:
    total += j
    lst1.append(total)

climb()

print(lst1)


count_list = [i[1] for i in all]
plt.plot(lst1)
plt.title('Mints Over Time')

ax = plt.axes()
ax.set_xticks(x_val)
ax.set_xticklabels(x_lst)
ax.set_yticks([0, total])
ax.set_yticklabels([0, total])


plt.show()
# print(count_list)



